(this.webpackJsonpbeaterlist=this.webpackJsonpbeaterlist||[]).push([[0],{178:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),s=n(17),r=n.n(s),o=(n(90),n(12)),c=n.n(o),l=n(19),u=n(15),h=n(49),f=n(62),d=n(195),p=n(207),j=n(35),b=n(83),g=n(52),v=n(208),m=n(201),O=n(213),y=n(202),x=n(182),C=n(211),w=n(203),S=n(204),k=n(205),T=n(214),_=n(180),P=n(51),A=n(29),D=n(30),B=n(20),H=n.n(B),z=n(14),M=["name","description","difficulties"],N=function(){function t(){Object(A.a)(this,t),this._playlistsHorizontalMode=!1,this._playlistColumnsToShow=void 0,Object(z.d)(this),this._playlistsHorizontalMode=H.a.get("playlistHorizontalMode")||!1,this._playlistColumnsToShow=H.a.get("playlistColumnsToShow")||function(){var t={};return M.forEach((function(e){return t[e]=!1})),t}()}return Object(D.a)(t,[{key:"playlistHorizontalMode",get:function(){return this._playlistsHorizontalMode},set:function(t){this._playlistsHorizontalMode=t,H.a.set("playlistHorizontalMode",t)}},{key:"playlistColumnsToShow",get:function(){return this._playlistColumnsToShow},set:function(t){this._playlistColumnsToShow=t,H.a.set("playlistColumnsToShow",this._playlistColumnsToShow)}},{key:"setPlaylistColumnToShow",value:function(t,e){this._playlistColumnsToShow[t]=e,H.a.set("playlistColumnsToShow",this._playlistColumnsToShow)}},{key:"getPlaylistColumnNamesToShow",value:function(){var t=Object.entries(this._playlistColumnsToShow).filter((function(t){var e=Object(u.a)(t,2);e[0];return e[1]})).map((function(t){var e=Object(u.a)(t,2),n=e[0];e[1];return n}));return 0===t.length?Object.keys(this._playlistColumnsToShow):t}}]),t}(),I=Object(a.createContext)(),J=n(6),L=function(t,e){switch(t){case"difficulties":return Object.entries(e.difficulties).filter((function(t){var e=Object(u.a)(t,2);e[0];return e[1]})).map((function(t){var e=Object(u.a)(t,2),n=e[0];e[1];return n})).join(",")}if(t in e)return e[t]},R=function(t){var e=t.replace(/([A-Z])/g," $1");return e.charAt(0).toUpperCase()+e.slice(1)},F=function(t){var e=t.type,n=t.idx,i=t.song,s=t.onRemoveSongClick,r=Object(a.useContext)(I).getPlaylistColumnNamesToShow();return Object(J.jsx)(P.b,{draggableId:i.hash,index:n,type:e,children:function(t,e){return Object(J.jsxs)(v.a.Row,Object(g.a)(Object(g.a)(Object(g.a)({isSelectable:!0,height:42,ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:[Object(J.jsx)(v.a.Cell,{flexBasis:40,flexGrow:0,children:Object(J.jsx)(m.a,{})}),Object(J.jsx)(v.a.Cell,{flexBasis:60,flexGrow:0,children:Object(J.jsx)(O.a,{src:i.coverURL,size:40})}),r.map((function(t){return Object(J.jsx)(v.a.TextCell,{children:L(t,i)},t)})),Object(J.jsx)(v.a.Cell,{flexBasis:35,flexGrow:0,children:Object(J.jsx)(y.a,{onClick:function(){return s(i)}})})]}),i.hash)}},i.hash)};var E=Object(h.a)((function(t){var e=t.playlist;console.log(e,"rerends.");var n=Object(a.useState)(!1),i=Object(u.a)(n,2),s=i[0],r=i[1],o=Object(a.useState)(!1),h=Object(u.a)(o,2),p=h[0],g=h[1],m=Object(a.useState)(!1),A=Object(u.a)(m,2),D=A[0],B=A[1],H=Object(a.useState)(!1),z=Object(u.a)(H,2),M=z[0],N=z[1],L=Object(a.useState)(!1),E=Object(u.a)(L,2),U=E[0],G=E[1],K=Object(a.useState)(void 0),W=Object(u.a)(K,2),Z=W[0],$=W[1],q=Object(a.useState)(null),Q=Object(u.a)(q,2),V=Q[0],X=Q[1],Y=Object(a.useState)(e.title),tt=Object(u.a)(Y,2),et=tt[0],nt=tt[1],at=Object(a.useState)(e.author),it=Object(u.a)(at,2),st=it[0],rt=it[1],ot=Object(a.useContext)(I).getPlaylistColumnNamesToShow(),ct="playlistSong";return Object(J.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",border:"default",marginTop:10},children:[" ",Object(J.jsxs)(f.a,{display:"flex",flexDirection:"row",alignItems:"center",children:[e.image&&Object(J.jsx)(O.a,{src:"data:image/png;"+e.image,size:50,onClick:function(){!function(t){var e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=!1,e.addEventListener("change",t),e.dispatchEvent(new MouseEvent("click"))}((function(t){var n="",a=new FileReader,i=t.target.files[0];a.readAsDataURL(i),a.onload=function(){n=a.result,e.image=n}}))}}),Object(J.jsx)(d.a,{margin:10,children:s?Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(x.a,{value:et,width:"150px",onChange:function(t){return nt(t.target.value)}})," ","-"," ",Object(J.jsx)(x.a,{value:st,width:"150px",onChange:function(t){return rt(t.target.value)}})]}):Object(J.jsxs)(J.Fragment,{children:[e.title," - ",e.author]})}),Object(J.jsx)(C.a,{content:"Edit Title & Author",children:s?Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(j.a,{intent:"success",onClick:function(){e.title=et,e.author=st,r(!1)},children:"Save"}),Object(J.jsx)(j.a,{intent:"danger",onClick:function(){nt(e.title),rt(e.author),r(!1)},children:"Discard"})]}):Object(J.jsx)(w.a,{onClick:function(){return r(!0)},size:30})}),Object(J.jsx)(C.a,{content:"Download",children:Object(J.jsx)(S.a,{size:25,onClick:function(){return function(t){var e=t.asBplistJson(),n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),n.setAttribute("download","".concat(t.title,".bplist")),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e)}})}),Object(J.jsx)(C.a,{content:"Delete",children:Object(J.jsx)(y.a,{size:25,onClick:function(){return g(!0)}})}),Object(J.jsx)(C.a,{content:"Add new song",children:Object(J.jsx)(k.a,{size:25,onClick:function(){return B(!0)}})}),Object(J.jsx)(T.a,{isShown:p,title:"Delete ".concat(e.title,"?"),onCloseComplete:function(){return g(!1)},onConfirm:function(){e.delete(),g(!1)},confirmLabel:"Confirm",intent:"danger",children:"This action is irreverisble!"}),Object(J.jsx)(T.a,{isShown:!!V,title:"Delete ".concat(null===V||void 0===V?void 0:V.name," from ").concat(e.title,"?"),onCloseComplete:function(){return X(null)},onConfirm:function(){e.removeSong(V),X(null)},confirmLabel:"Confirm",intent:"danger",children:"This action is irreverisble!"}),Object(J.jsxs)(T.a,{shouldCloseOnOverlayClick:!1,isShown:D,title:"Add new song to ".concat(e.title),onCloseComplete:function(){return B(!1)},onConfirm:Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,G(!1),N(!0),t.next=5,e.addSongByKey(Z);case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),G(!0),console.log(t.t0);case 11:return t.prev=11,N(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,7,11,14]])}))),confirmLabel:"Add",children:[M&&Object(J.jsx)(_.a,{}),"Add the song key you want to add here:",Object(J.jsx)(x.a,{isInvalid:U,value:Z,onChange:function(t){return $(t.target.value)}})]})]}),Object(J.jsx)(P.a,{onDragEnd:function(t){var n=t.destination,a=t.source;if(console.log(n,a),n&&a){var i=n.index,s=a.index,r=Object(b.a)(e.songs),o=r[s];r.splice(s,1),r.splice(i,0,o),e.songs=r}},children:Object(J.jsxs)(v.a,{maxWidth:"80%",children:[Object(J.jsxs)(v.a.Head,{height:42,children:[Object(J.jsx)(v.a.HeaderCell,{flexBasis:40,flexGrow:0}),Object(J.jsx)(v.a.HeaderCell,{flexBasis:60,flexGrow:0,children:"Cover"}),ot.map((function(t){return Object(J.jsx)(v.a.HeaderCell,{children:R(t)},t)}))]}),Object(J.jsx)(v.a.Body,{children:Object(J.jsx)(P.c,{droppableId:e.title,type:ct,children:function(t,n){return Object(J.jsxs)("div",{ref:t.innerRef,children:[e.songs.map((function(t,e){return Object(J.jsx)(F,{type:ct,idx:e,song:t,onRemoveSongClick:function(t){return X(t)}})})),t.placeholder]})}})})]})})]})})),U=n(206),G=function(t){var e=t.onImportClick;return Object(J.jsx)(U.a,{multiple:!0,accept:".bplist,.json",width:250,onChange:function(){var t=Object(l.a)(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.next=3,Promise.all(n.map(function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e.name.split(".")[1],t.t1=JSON,t.next=4,e.text();case 4:return t.t2=t.sent,t.t3=t.t1.parse.call(t.t1,t.t2),t.abrupt("return",{type:t.t0,data:t.t3});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:a=t.sent,e(a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),placeholder:"Import playlist(s)"})},K=n(63),W=function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://beatsaver.com/api/maps/by-hash/".concat(e));case 2:return t.abrupt("return",t.sent.json());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Z=function(){var t=Object(l.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://beatsaver.com/api/maps/detail/".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$=new(function(){function t(){var e;Object(A.a)(this,t),this.songCache=null,this.songCache=null!==(e=H.a.get("songCache"))&&void 0!==e?e:{}}return Object(D.a)(t,[{key:"manualAddSongData",value:function(t){this.songCache[t.hash]=t,H.a.set("songCache",this.songCache)}},{key:"retrieveSongData",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!e in this.songCache)){t.next=5;break}return t.next=3,W(e);case 3:n=t.sent,this.songCache[e]=n;case 5:H.a.set("songCache",this.songCache);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"retrieveMultipleSongData",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,a,i,s,r,o,l=this,u=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=u.length>1&&void 0!==u[1]?u[1]:100,a=e.filter((function(t){return!(t in l.songCache)})),console.log("getting hashes",a),i=Object(K.a)(a),t.prev=4,i.s();case 6:if((s=i.n()).done){t.next=17;break}return r=s.value,console.log("getting from beat-saver server ",r),t.next=11,W(r);case 11:return o=t.sent,t.next=14,new Promise((function(t){return setTimeout(t,n)}));case 14:this.songCache[r]=o;case 15:t.next=6;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(4),i.e(t.t0);case 22:return t.prev=22,i.f(),t.finish(22);case 25:H.a.set("songCache",this.songCache);case 26:case"end":return t.stop()}}),t,this,[[4,19,22,25]])})));return function(e){return t.apply(this,arguments)}}()},{key:"getSongDataByHash",value:function(t){return!t in this.songCache&&this.retrieveSongData(t),this.songCache[t]}}]),t}()),q=function(){function t(){var e=this;Object(A.a)(this,t),this.playlists=[],this.addPlaylistFromBplistData=function(){var t=Object(l.a)(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.retrieveMultipleSongData(n.songs.map((function(t){return t.hash})));case 2:a=new V({image:n.image,title:n.playlistTitle,author:n.playlistAuthor,songs:n.songs},e),e.playlists.push(a),e.saveAllPlaylists();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Object(z.d)(this);var n=H.a.get("playlists");if(n){var a,i=[],s=Object(K.a)(n);try{for(s.s();!(a=s.n()).done;){var r=a.value;i.push(new V(r,this))}}catch(o){s.e(o)}finally{s.f()}this.playlists=i}}return Object(D.a)(t,[{key:"createNewPlaylist",value:function(){var t=new V({image:"",title:"New Playlist",author:"Beaterlist",songs:[]},this);this.playlists.push(t),this.saveAllPlaylists()}},{key:"deletePlaylist",value:function(t){var e=this.playlists.indexOf(t);this.playlists.splice(e,1),this.saveAllPlaylists()}},{key:"saveAllPlaylists",value:function(){var t=this.playlists.map((function(t){return t.asJson()}));H.a.set("playlists",t)}}]),t}(),Q=Object(a.createContext)(),V=function(){function t(e,n){Object(A.a)(this,t),this._image="",this._title="",this._author="",this._songs=[],this.store=void 0,Object(z.d)(this),this._image=e.image,this._title=e.title,this._author=e.author,this._songs=e.songs.map((function(t){return new X(t)})),this.store=n}return Object(D.a)(t,[{key:"image",get:function(){return this._image},set:function(t){this._image=t,this.store.saveAllPlaylists()}},{key:"title",get:function(){return this._title},set:function(t){this._title=t,this.store.saveAllPlaylists()}},{key:"author",get:function(){return this._author},set:function(t){this._author=t,this.store.saveAllPlaylists()}},{key:"songs",get:function(){return this._songs},set:function(t){this._songs=t,this.store.saveAllPlaylists()}},{key:"delete",value:function(){this.store.deletePlaylist(this)}},{key:"removeSong",value:function(t){var e=this.songs.indexOf(t);this.songs.splice(e,1)}},{key:"addSongByKey",value:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z(e);case 3:return n=t.sent,t.next=6,n.json();case 6:if(a=t.sent,console.log(a),!this.songs.find((function(t){return t.hash===a.hash}))){t.next=11;break}return t.abrupt("return");case 11:$.manualAddSongData(a),this._songs.push(new X({hash:a.hash})),this.store.saveAllPlaylists(),t.next=19;break;case 16:throw t.prev=16,t.t0=t.catch(0),t.t0;case 19:case"end":return t.stop()}}),t,this,[[0,16]])})));return function(e){return t.apply(this,arguments)}}()},{key:"asJson",value:function(){return{image:this.image,title:this.title,author:this.author,songs:this.songs.map((function(t){return t.asJson()}))}}},{key:"asBplistJson",value:function(){return{image:this.image,playlistTitle:this.title,playlistAuthor:this.author,songs:this.songs.map((function(t){return t.asBplistJson()}))}}}]),t}(),X=function(){function t(e){Object(A.a)(this,t),this.hash=null,this.beatSaverSongObject=void 0,this.hash=e.hash,this.beatSaverSongObject=$.getSongDataByHash(this.hash)}return Object(D.a)(t,[{key:"name",get:function(){var t;return null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.metadata.songName}},{key:"author",get:function(){var t;return null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.metadata.songAuthorName}},{key:"levelAuthor",get:function(){var t;return null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.metadata.levelAuthorName}},{key:"difficulties",get:function(){var t;return null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.metadata.difficulties}},{key:"description",get:function(){var t;return null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.description}},{key:"coverURL",get:function(){var t;return"https://beatsaver.com"+(null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.coverURL)}},{key:"asJson",value:function(){return{hash:this.hash}}},{key:"asBplistJson",value:function(){return{hash:this.hash,levelid:"custom_level_".concat(this.hash),songName:this.beatSaverSongObject.metadata.name,levelAuthorName:this.beatSaverSongObject.metadata.levelAuthorName,difficulties:this.beatSaverSongObject.metadata.characteristics.flatMap((function(t){return Object.entries(t.difficulties).filter((function(t){var e=Object(u.a)(t,2);e[0];return null!==e[1]})).map((function(e){var n=Object(u.a)(e,2),a=n[0];n[1];return{characteristic:t.name,name:a}}))}))}}}]),t}(),Y=Object(h.a)((function(){var t=Object(a.useContext)(I),e=t.playlistHorizontalMode,n=t.playlistColumnsToShow,i=Object(a.useContext)(Q),s=i.playlists,r=Object.entries(n).filter((function(t){var e=Object(u.a)(t,2);e[0];return e[1]})).map((function(t){var e=Object(u.a)(t,2),n=e[0];e[1];return n}));return 0===r.length&&(r=Object.keys(n)),Object(J.jsxs)(f.a,{width:"100%",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",border:"default",children:[Object(J.jsx)(f.a,{width:"100%",height:"50px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingLeft:"20px",paddingRight:"20px",paddingTop:"10px",paddingBottom:"10px",backgroundColor:"#012548",children:Object(J.jsx)(d.a,{color:"white",children:"BeaterList"})}),Object(J.jsxs)("div",{style:{width:"100%",flexDirection:"row",display:"flex"},children:[Object(J.jsxs)(f.a,{minWidth:"300px",padding:30,children:[Object(J.jsx)(d.a,{children:"Playlists Config"}),Object(J.jsx)(p.a,{label:"Horizontal Mode",checked:e,onChange:function(e){t.playlistHorizontalMode=e.target.checked}}),Object(J.jsx)(d.a,{children:"Columns To Show"}),Object.keys(t.playlistColumnsToShow).map((function(e){return Object(J.jsx)(p.a,{label:e,checked:n[e],onChange:function(n){return t.setPlaylistColumnToShow(e,n.target.checked)}},e)})),Object(J.jsx)(G,{onImportClick:function(){var t=Object(l.a)(c.a.mark((function t(e){var n,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.map((function(t){return i.addPlaylistFromBplistData(t.data)})),t.next=3,Promise.all(n);case 3:a=t.sent,console.log(e,"plist",a,n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),Object(J.jsx)(j.a,{onClick:function(){return i.createNewPlaylist()},children:"Add new playlist"})]}),Object(J.jsx)(f.a,{width:"100%",height:"80vh",display:"flex",flexDirection:e?"row":"column",border:"default",children:s.map((function(t,e){return Object(J.jsx)(E,{playlist:t},t.title+e)}))})]})]})})),tt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,216)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),a(t),i(t),s(t),r(t)}))};r.a.render(Object(J.jsx)(i.a.StrictMode,{children:Object(J.jsx)(Q.Provider,{value:new q,children:Object(J.jsx)(I.Provider,{value:new N,children:Object(J.jsx)(Y,{})})})}),document.getElementById("root")),tt()},90:function(t,e,n){}},[[178,1,2]]]);
//# sourceMappingURL=main.d6dce955.chunk.js.map