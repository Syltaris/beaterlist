(this.webpackJsonpbeaterlist=this.webpackJsonpbeaterlist||[]).push([[0],{191:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(20),r=n.n(s),o=(n(99),n(17)),c=n(29),l=n(234),u=n(14),h=n(35),d=n(12),g=n(26),f=n(27),p=n(21),b=n.n(p),v=n(15),j=["cover","name","songAuthor","levelAuthor","duration","difficulties","downloads","plays","upvotes","downvotes","rating","uploadDate","key","hash","description"],y=new(function(){function e(){Object(g.a)(this,e),this._playlistsHorizontalMode=!1,this._playlistColumnsToShow=void 0,this._showBeatSaverBrowser=!1,Object(v.d)(this),this._playlistsHorizontalMode=b.a.get("playlistHorizontalMode")||!1,this._playlistColumnsToShow=b.a.get("playlistColumnsToShow")||function(){var e={};return j.forEach((function(t){return e[t]=!1})),e.cover=!0,e.name=!0,e}(),this._showBeatSaverBrowser=b.a.get("showBeatSaverBrowser")||!1}return Object(f.a)(e,[{key:"playlistHorizontalMode",get:function(){return this._playlistsHorizontalMode},set:function(e){this._playlistsHorizontalMode=e,b.a.set("playlistHorizontalMode",this._playlistsHorizontalMode)}},{key:"playlistColumnsToShow",get:function(){return this._playlistColumnsToShow},set:function(e){this._playlistColumnsToShow=e,b.a.set("playlistColumnsToShow",this._playlistColumnsToShow)}},{key:"showBeatSaverBrowser",get:function(){return this._showBeatSaverBrowser},set:function(e){this._showBeatSaverBrowser=e,this._showBeatSaverBrowser=b.a.set("showBeatSaverBrowser",this._showBeatSaverBrowser)}},{key:"setPlaylistColumnToShow",value:function(e,t){this._playlistColumnsToShow[e]=t,b.a.set("playlistColumnsToShow",this._playlistColumnsToShow)}},{key:"getPlaylistColumnNamesToShow",value:function(){var e=Object.entries(this._playlistColumnsToShow).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return n}));return 0===e.length?Object.keys(this._playlistColumnsToShow):e}}]),e}()),x=Object(a.createContext)(y),O=n(9),m=n.n(O),w=n(16),S=n(237),k=n(194),_=n(91),C=n(238),B=n(196),P=n(218),T=n(198),A=n(219),L=n(220),I=n(221),D=n(222),H=n(223),R=n(197),E=n(60),N=n(3);var z=Object(o.b)((function(e){var t=e.playlist,n=Object(a.useState)(!1),i=Object(d.a)(n,2),s=i[0],r=i[1],o=Object(a.useState)(!1),c=Object(d.a)(o,2),u=c[0],g=c[1],f=Object(a.useState)(!1),p=Object(d.a)(f,2),b=p[0],v=p[1],j=Object(a.useState)(!1),y=Object(d.a)(j,2),x=y[0],O=y[1],z=Object(a.useState)(!1),M=Object(d.a)(z,2),F=M[0],J=M[1],U=Object(a.useState)(""),G=Object(d.a)(U,2),K=G[0],W=G[1],Y=Object(a.useState)(t.title),V=Object(d.a)(Y,2),X=V[0],q=V[1],Z=Object(a.useState)(t.author),Q=Object(d.a)(Z,2),$=Q[0],ee=Q[1];return Object(N.jsxs)(h.a,{display:"flex",flexDirection:"row",alignItems:"center",paddingBottom:"5px",children:[Object(N.jsx)(S.a,{src:t.image&&"data:image/png;"+t.image,name:t.title,size:50,onClick:function(){window.gtag("event","playlistImageChange",{event_category:"playlist",event_label:"playlistImageChange"}),function(e){var t=document.createElement("input");t.type="file",t.accept="image/*",t.multiple=!1,t.addEventListener("change",e),t.dispatchEvent(new MouseEvent("click"))}((function(e){var n="",a=new FileReader,i=e.target.files[0];a.readAsDataURL(i),a.onload=function(){n=a.result,t.image=n,l.a.success("Image saved and updated.")}}))}}),Object(N.jsx)(k.a,{margin:10,children:s?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(_.a,{value:X,width:"100px",onChange:function(e){return q(e.target.value)}})," ","-"," ",Object(N.jsx)(_.a,{value:$,width:"100px",onChange:function(e){return ee(e.target.value)}}),Object(N.jsx)(C.a,{content:"Save/Confirm",children:Object(N.jsx)(B.a,{icon:P.a,intent:"success",onClick:function(){window.gtag("event","playlistTitleAuthorUpdate",{event_category:"playlist",event_label:"playlistTitleAuthorUpdate"}),t.title=X,t.author=$,r(!1)},marginLeft:"2px"})}),Object(N.jsx)(C.a,{content:"Discard Changes",children:Object(N.jsx)(B.a,{icon:T.a,intent:"danger",onClick:function(){q(t.title),ee(t.author),r(!1)},marginLeft:"2px"})})]}):Object(N.jsxs)(N.Fragment,{children:[t.title," - ",t.author]})}),Object(N.jsxs)("div",{style:{marginLeft:"auto",marginRight:0},children:[Object(N.jsx)(C.a,{content:"Edit Title & Author",children:Object(N.jsx)(B.a,{icon:A.a,onClick:function(){window.gtag("event","playlistEditToggle",{event_category:"playlist",event_label:"playlistEditToggle",value:!s}),r(!s)},marginLeft:"2px"})}),Object(N.jsx)(C.a,{content:"Download",children:Object(N.jsx)(B.a,{icon:L.a,marginLeft:"2px",onClick:function(){window.gtag("event","savePlaylst",{event_category:"playlist",event_label:"savePlaylst"}),function(e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e.asBplistJson()))),t.setAttribute("download","".concat(e.title,".bplist")),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}(t)}})}),Object(N.jsx)(C.a,{content:"Delete",children:Object(N.jsx)(B.a,{icon:I.a,marginLeft:"2px",onClick:function(){window.gtag("event","deletePlaylist",{event_category:"playlist",event_label:"deletePlaylist"}),g(!0)}})}),Object(N.jsx)(C.a,{content:"Add new song",children:Object(N.jsx)(B.a,{icon:D.a,marginLeft:"2px",onClick:function(){window.gtag("event","addSongByKey",{event_category:"playlist",event_label:"addSongByKey"}),v(!0)}})})]}),Object(N.jsx)(H.a,{isShown:u,title:"Delete ".concat(t.title,"?"),onCloseComplete:function(){return g(!1)},onConfirm:function(){window.gtag("event","deletePlaylistConfirmation",{event_category:"playlist",event_label:"deletePlaylistConfirmation"}),t.delete(),l.a.success("".concat(t.title," deleted successfully.")),g(!1)},confirmLabel:"Confirm",intent:"danger",children:"This action is irreverisble!"}),Object(N.jsxs)(H.a,{shouldCloseOnOverlayClick:!1,isShown:b,title:"Add new song to ".concat(t.title),onCloseComplete:function(){return v(!1)},onConfirm:Object(w.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,J(!1),O(!0),e.next=5,t.addSongByKey(K);case 5:n=e.sent,l.a.success("".concat(n.name," added to ").concat(t.title,".")),window.gtag("event","addNewSongByKeySuccess",{event_category:"playlist",event_label:"addNewSongByKeySuccess"}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),J(!0),l.a.danger(e.t0.message),window.gtag("event","addNewSongByKeyFail",{event_category:"playlist",event_label:"addNewSongByKeyFail"});case 15:return e.prev=15,O(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,10,15,18]])}))),confirmLabel:"Add",children:[x&&Object(N.jsx)(R.a,{}),Object(N.jsx)(E.a,{children:"Add the song key \ud83d\udd11 you want to add here:"}),Object(N.jsx)(_.a,{marginLeft:"10px",width:"80px",isInvalid:F,value:K,onChange:function(e){return W(e.target.value)}})]})]})})),M=n(233),F=n(224),J=n(242),U=function(e){var t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)},G={easy:{text:"EZ",color:"green"},normal:{text:"N",color:"blue"},hard:{text:"H",color:"yellow"},expert:{text:"E",color:"red"},expertPlus:{text:"E+",color:"purple"}},K=function(e,t){switch(e){case"difficulties":return Object.entries(t.difficulties).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return n})).join(",")}if(e in t)return t[e]},W=function(e){var t={flexBasis:120,flexGrow:0,flexShrink:0};return"description"===e?t={flexBasis:600,flexGrow:0,flexShrink:0}:"difficulties"===e?t={flexBasis:150,flexGrow:0,flexShrink:0}:"cover"===e?t={flexBasis:60,flexGrow:0,flexShrink:0}:"hash"===e?t={flexBasis:300,flexGrow:0,flexShrink:0}:["downloads","plays","upvotes","downvotes","rating","key"].includes(e)&&(t={flexBasis:72,flexGrow:0,flexShrink:0}),t},Y=function(e,t){return"cover"===e?Object(N.jsx)(M.a.Cell,Object(u.a)(Object(u.a)({},W(e)),{},{children:Object(N.jsx)(S.a,{src:t.coverURL,size:40})}),e):"difficulties"===e?Object(N.jsx)(M.a.Cell,Object(u.a)(Object(u.a)({},W(e)),{},{children:Object.entries(t.difficulties).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return n})).sort((function(e,t){var n=Object.keys(G);return n.indexOf(e)-n.indexOf(t)})).map((function(e){return function(e){if(e in G){var t=G[e],n=t.text,a=t.color;return Object(N.jsx)(J.a,{color:a,children:n},e)}console.error("missing difficulty key: ",e)}(e)}))}),e):Object(N.jsx)(M.a.TextCell,Object(u.a)(Object(u.a)({},W(e)),{},{children:K(e,t)}),e)},V=function(e){switch(e){case"upvotes":return"\ud83d\udc4d";case"downvotes":return"\ud83d\udc4e";case"downloads":return"\ud83d\udcbe";case"plays":return"\u25b6\ufe0f";case"rating":return"\ud83d\udcaf";case"key":return"\ud83d\udd11";default:return U(e)}},X=function(e){var t=e.idx,n=e.playlistId,i=e.song,s=e.onRemoveSongClick,r=Object(a.useContext)(x).getPlaylistColumnNamesToShow();return Object(N.jsx)(c.b,{draggableId:"".concat(n,"-").concat(i.hash),index:t,children:function(e){return Object(N.jsxs)(M.a.Row,Object(u.a)(Object(u.a)(Object(u.a)({isSelectable:!0,height:42,ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:[Object(N.jsx)(M.a.Cell,{flexBasis:40,flexGrow:0,flexShrink:0,children:Object(N.jsx)(F.a,{})}),r.map((function(e){return Y(e,i)})),Object(N.jsx)(M.a.Cell,{flexBasis:35,flexGrow:0,flexShrink:0,marginRight:0,marginLeft:"auto",children:Object(N.jsx)(I.a,{onClick:function(){return s(i)}})})]}),i.hash)}},i.hash)},q=Object(o.b)((function(e){var t=e.playlist,n=Object(a.useContext)(x).getPlaylistColumnNamesToShow(),i=Object(a.useState)(null),s=Object(d.a)(i,2),r=s[0],o=s[1];return Object(N.jsxs)(M.a,{minWidth:"400px",overflowX:"scroll",children:[Object(N.jsxs)(M.a.Head,{height:42,children:[Object(N.jsx)(M.a.HeaderCell,{flexBasis:40,flexGrow:0}),n.map((function(e){return Object(N.jsx)(M.a.TextHeaderCell,Object(u.a)(Object(u.a)({},W(e)),{},{children:V(e)}),e)})),Object(N.jsx)(M.a.HeaderCell,{flexBasis:35,flexGrow:0,flexShrink:0,marginRight:0,marginLeft:"auto"})]}),Object(N.jsx)(M.a.Body,{overflow:"visible",children:Object(N.jsx)(c.c,{droppableId:t.id,children:function(e,n){return Object(N.jsxs)("div",{ref:e.innerRef,style:{minHeight:"40px"},children:[t.songs.map((function(e,n){return Object(N.jsx)(X,{idx:n,playlistId:t.id,song:e,onRemoveSongClick:function(e){return o(e)}},e.hash)})),e.placeholder]})}},t.id)}),Object(N.jsx)(H.a,{isShown:!!r,title:"Delete ".concat(null===r||void 0===r?void 0:r.name," from ").concat(t.title,"?"),onCloseComplete:function(){return o(null)},onConfirm:function(){t.removeSong(r),o(null),l.a.success("".concat(r.name," deleted from ").concat(t.title,"."))},confirmLabel:"Confirm",intent:"danger",children:"This action is irreverisble!"})]})})),Z=Object(o.b)((function(e){var t=e.playlist,n=Object(a.useContext)(x);return Object(N.jsxs)(h.a,{style:{display:"flex",flexDirection:"column",padding:10,margin:10,maxWidth:n.playlistHorizontalMode?"800px":"100%",borderRadius:15,backgroundColor:"white"},elevation:2,children:[Object(N.jsx)(z,{playlist:t}),Object(N.jsx)(q,{playlist:t})]})})),Q=n(43),$=n(236),ee=function(){var e=Object(w.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://beatsaver.com/api/maps/by-hash/".concat(t));case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(w.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://beatsaver.com/api/maps/detail/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(w.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://beatsaver.com/api/maps/".concat(n,"/").concat(t));case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ae=function(){var e=Object(w.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://beatsaver.com/api/search/text/?q=".concat(n,"&").concat(t));case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ie=["hot","rating","latest","downloads","plays"],se=new(function(){function e(){var t=this;Object(g.a)(this,e),this._songsList=[],this._totalPages=null,this._page=0,this._search="",this._category=ie[0],this._loading=!1,this.fetchSongs=Object(w.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading=!0,e.prev=1,null===t.search||""===t.search){e.next=8;break}return e.next=5,ae(t.page,t.search);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,ne(t.page,t.category);case 10:n=e.sent;case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:t.totalPages=n.lastPage,t.songsList=n.docs,t.loading=!1;case 19:case"end":return e.stop()}}),e,null,[[1,13]])}))),Object(v.d)(this),this.fetchSongs()}return Object(f.a)(e,[{key:"songsList",get:function(){return this._songsList},set:function(e){this._songsList=e}},{key:"totalPages",get:function(){return this._totalPages},set:function(e){this._totalPages=e}},{key:"page",get:function(){return this._page},set:function(e){this._page=e}},{key:"loading",get:function(){return this._loading},set:function(e){this._loading=e}},{key:"category",get:function(){return this._category},set:function(e){e!==this._category&&(this.page=0),this._category=e}},{key:"search",get:function(){return this._search},set:function(e){e!==this._search&&(this.page=0),this._search=e}}]),e}()),re=Object(a.createContext)(se),oe=new(function(){function e(){var t;Object(g.a)(this,e),this.songCache=null,this.songCache=null!==(t=b.a.get("songCache"))&&void 0!==t?t:{}}return Object(f.a)(e,[{key:"manualAddSongData",value:function(e){this.songCache[e.hash]=e,b.a.set("songCache",this.songCache)}},{key:"retrieveSongData",value:function(){var e=Object(w.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t in this.songCache){e.next=5;break}return e.next=3,ee(t);case 3:n=e.sent,this.songCache[t]=n;case 5:b.a.set("songCache",this.songCache);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"retrieveMultipleSongData",value:function(){var e=Object(w.a)(m.a.mark((function e(t){var n,a,i,s,r,o,c=this,l=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=l.length>1&&void 0!==l[1]?l[1]:500,a=t.filter((function(e){return!(e in c.songCache)})),i=Object(Q.a)(a),e.prev=3,i.s();case 5:if((s=i.n()).done){e.next=15;break}return r=s.value,e.next=9,ee(r);case 9:return o=e.sent,e.next=12,new Promise((function(e){return setTimeout(e,n)}));case 12:this.songCache[r]=o;case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:b.a.set("songCache",this.songCache);case 24:case"end":return e.stop()}}),e,this,[[3,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSongDataByHash",value:function(e){return e in this.songCache||this.retrieveSongData(e),this.songCache[e]}}]),e}()),ce=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(g.a)(this,e),this._hash=null,this.beatSaverSongObject=void 0,this._hash=t.hash,this.beatSaverSongObject=null===n?oe.getSongDataByHash(this.hash):n}return Object(f.a)(e,[{key:"hash",get:function(){return this._hash}},{key:"coverURL",get:function(){var e;return"https://beatsaver.com"+(null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.coverURL)}},{key:"name",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.metadata.songName}},{key:"songAuthor",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.metadata.songAuthorName}},{key:"levelAuthor",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.metadata.levelAuthorName}},{key:"difficulties",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.metadata.difficulties}},{key:"description",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.description}},{key:"duration",get:function(){var e,t=new Date(0);return t.setSeconds(null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.metadata.duration),t.toISOString().substr(14,5)}},{key:"downloads",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.stats.downloads}},{key:"plays",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.stats.plays}},{key:"upvotes",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.stats.upVotes}},{key:"downvotes",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.stats.downVotes}},{key:"rating",get:function(){var e,t;return Number.parseFloat(null!==(e=100*(null===(t=this.beatSaverSongObject)||void 0===t?void 0:t.stats.rating))&&void 0!==e?e:0).toPrecision(2)}},{key:"uploadDate",get:function(){var e;return new Date(null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.uploaded).toLocaleDateString()}},{key:"key",get:function(){var e;return null===(e=this.beatSaverSongObject)||void 0===e?void 0:e.key}},{key:"asJson",value:function(){return{hash:this.hash}}},{key:"asBplistJson",value:function(){return{hash:this.hash,levelid:"custom_level_".concat(this.hash),songName:this.beatSaverSongObject.metadata.name,levelAuthorName:this.beatSaverSongObject.metadata.levelAuthorName,difficulties:this.beatSaverSongObject.metadata.characteristics.flatMap((function(e){return Object.entries(e.difficulties).filter((function(e){var t=Object(d.a)(e,2);t[0];return null!==t[1]})).map((function(t){var n=Object(d.a)(t,2),a=n[0];n[1];return{characteristic:e.name,name:a}}))}))}}}]),e}(),le=function(){function e(t,n){Object(g.a)(this,e),this._id=null,this._image=null,this._title="",this._author="",this._songs=[],this.store=void 0,Object(v.d)(this),this._id=t.id,this._image=t.image,this._title=t.title,this._author=t.author,this._songs=t.songs.map((function(e){return new ce(e)})),this.store=n}return Object(f.a)(e,[{key:"id",get:function(){return this._id}},{key:"image",get:function(){return this._image},set:function(e){this._image=e,this.store.saveAllPlaylists()}},{key:"title",get:function(){return this._title},set:function(e){this._title=e,this.store.saveAllPlaylists()}},{key:"author",get:function(){return this._author},set:function(e){this._author=e,this.store.saveAllPlaylists()}},{key:"songs",get:function(){return this._songs},set:function(e){this._songs=e,this.store.saveAllPlaylists()}},{key:"delete",value:function(){this.store.deletePlaylist(this)}},{key:"removeSong",value:function(e){var t=this._songs.indexOf(e);this._songs.splice(t,1)}},{key:"insertSongAtIdx",value:function(e,t){this._songs.splice(t,0,e)}},{key:"addSongByKey",value:function(){var e=Object(w.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),Error("Could not retreive song with key: ".concat(t));case 12:if(!this._songs.find((function(e){return e.hash===n.hash}))){e.next=15;break}throw Error("Song already exists in playlist.");case 15:return oe.manualAddSongData(n),this._songs.push(new ce({hash:n.hash})),this.store.saveAllPlaylists(),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addSongBySongData",value:function(){var e=Object(w.a)(m.a.mark((function e(t){var n,a,i=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:void 0,a=t.hash,void 0===n&&(n=this._songs.length),e.prev=3,!this._songs.find((function(e){return e.hash===a}))){e.next=6;break}return e.abrupt("return");case 6:oe.manualAddSongData(t),this._songs.splice(n,0,new ce({hash:a})),this.store.saveAllPlaylists(),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(3),e.t0;case 14:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"asJson",value:function(){return{id:this._id,image:this.image,title:this.title,author:this.author,songs:this.songs.map((function(e){return e.asJson()}))}}},{key:"asBplistJson",value:function(){return{image:this.image,playlistTitle:this.title,playlistAuthor:this.author,songs:this.songs.map((function(e){return e.asBplistJson()}))}}}]),e}(),ue=new(function(){function e(){var t=this;Object(g.a)(this,e),this._playlists=[],this.addPlaylistFromBplistData=function(){var e=Object(w.a)(m.a.mark((function e(n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.retrieveMultipleSongData(n.songs.map((function(e){return e.hash})));case 2:a=new le({id:t.getNewId(),image:n.image,title:n.playlistTitle,author:n.playlistAuthor,songs:n.songs},t),t.appendPlaylist(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(v.d)(this);var n=b.a.get("playlists");if(n){var a,i=[],s=Object(Q.a)(n);try{for(s.s();!(a=s.n()).done;){var r=a.value;i.push(new le(r,this))}}catch(o){s.e(o)}finally{s.f()}this._playlists=i}}return Object(f.a)(e,[{key:"playlists",get:function(){return this._playlists}},{key:"getNewId",value:function(){for(var e=[this._playlists.map((function(e){return e.id}))],t=Object($.a)();e.includes(t);)t=Object($.a)();return t}},{key:"createNewPlaylist",value:function(){var e=new le({id:this.getNewId(),image:null,title:"New Playlist",author:"Beaterlist",songs:[]},this);this.appendPlaylist(e)}},{key:"appendPlaylist",value:function(e){this._playlists.push(e),this.saveAllPlaylists()}},{key:"deletePlaylist",value:function(e){var t=this._playlists.indexOf(e);this._playlists.splice(t,1),this.saveAllPlaylists()}},{key:"movePlaylist",value:function(e,t){this._playlists.splice(this._playlists.indexOf(e),1),this._playlists.splice(t,0,e),this.saveAllPlaylists()}},{key:"saveAllPlaylists",value:function(){var e=this._playlists.map((function(e){return e.asJson()}));b.a.set("playlists",e)}}]),e}()),he=Object(a.createContext)(ue),de="PLAYLIST",ge=Object(o.b)((function(e){var t=e.userPreferences,n=e.playlistStore,a=t.playlistHorizontalMode;return Object(N.jsx)(c.c,{droppableId:de,type:de,direction:a?"horizontal":"vertical",children:function(e){return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{ref:e.innerRef,style:{width:a?"100%":"50%",height:"100vh",display:"flex",flexDirection:a?"row":"column",border:"default",overflowX:"scroll"},children:Object(N.jsx)(o.a,{children:function(){return n.playlists.map((function(e,t){return Object(N.jsx)(c.b,{draggableId:e.id,index:t,children:function(n){return Object(N.jsx)("div",Object(u.a)(Object(u.a)(Object(u.a)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{children:Object(N.jsx)(Z,{playlistKey:"".concat(e.title,"|").concat(t),playlist:e},"".concat(e.title,"|").concat(t))}))}},e.id)}))}})}),e.placeholder]})}})})),fe=function(){var e=Object(a.useContext)(x),t=Object(a.useContext)(he);return Object(N.jsx)(ge,{userPreferences:e,playlistStore:t})},pe=n(227),be=n(228),ve=n(240),je=new(function(){function e(){var t=this;Object(g.a)(this,e),this._audioPlayer=new Audio,this._previewingSongFile=null,this._previewingSongHash=null,this._loading=!1,this._paused=!1,Object(v.d)(this),this._audioPlayer.onended=function(){return t.previewingSongHash=null}}return Object(f.a)(e,[{key:"previewingSongHash",get:function(){return this._previewingSongHash},set:function(e){this._previewingSongHash=e}},{key:"loading",get:function(){return this._loading},set:function(e){this._loading=e}},{key:"paused",get:function(){return this._paused},set:function(e){this._paused=e}},{key:"playSongSrc",value:function(e){this.paused=!1,this._audioPlayer.pause(),this._audioPlayer.currentTime=0,this._audioPlayer.src=e,this._audioPlayer.play()}},{key:"play",value:function(){this.paused=!1,this._audioPlayer.play()}},{key:"pause",value:function(){this.paused=!0,this._audioPlayer.pause()}}]),e}()),ye=n(58),xe=n.n(ye),Oe=n(225),me=n(226),we=function(){var e=Object(w.a)(m.a.mark((function e(t){var n,a,i,s,r,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je.paused||je.pause(),je.loading=!0,je.previewingSongHash=t.hash,e.next=5,fetch("https://beatsaver.com"+t.downloadURL);case 5:return n=e.sent,a=new xe.a,e.t0=a,e.next=10,n.blob();case 10:return e.t1=e.sent,e.next=13,e.t0.loadAsync.call(e.t0,e.t1);case 13:if(i=e.sent,!(s=Object.entries(i.files).find((function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return n.includes(".egg")})))){e.next=24;break}return e.next=18,s[1].async("arraybuffer");case 18:r=e.sent,console.log(r),o=new Blob([r],{type:"audio/wav"}),(c=new FileReader).onload=function(e){console.log(e),je.playSongSrc(window.URL.createObjectURL(o)),je.loading=!1},c.readAsArrayBuffer(o);case 24:console.log(t,s);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(e){return je.previewingSongHash!==e.hash?Oe.a:je.loading?void 0:je.paused?Oe.a:me.a},ke=Object(o.b)((function(e){var t=e.songData;return Object(N.jsx)(B.a,{isLoading:je.previewingSongHash===t.hash&&je.loading,icon:Se(t),size:"small",onClick:function(){return function(e){je.previewingSongHash===e.hash?(je.paused&&je.play(),je.pause()):we(e)}(t)}})})),_e="BEAT_SAVER_BROWSER",Ce=Object(o.b)((function(){var e=Object(a.useContext)(re),t=Object(a.useContext)(x).getPlaylistColumnNamesToShow();return Object(N.jsxs)(h.a,{maxWidth:"600px",height:"100vh",paddingLeft:"20px",paddingRight:"20px",backgroundColor:"white",children:[Object(N.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(N.jsx)(k.a,{marginTop:"10px",marginBottom:"10px",children:"BeatSaver Browser"}),e.loading&&Object(N.jsx)(R.a,{marginLeft:"auto",marginRight:"0px"})]}),Object(N.jsx)(E.a,{children:"Drag songs from here to your playlists to add songs directly. Currently, you can only either filter by category, or do a search, but not in conjunction with each other."}),Object(N.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:Object(N.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:10,marginTop:10},children:[Object(N.jsx)(pe.a,{width:"100px",marginRight:"30px",value:e.category,onChange:function(t){e.search="",e.category=t.target.value,e.fetchSongs()},children:ie.map((function(e){return Object(N.jsx)("option",{value:e,children:e.toLocaleUpperCase()},e)}))}),Object(N.jsx)(be.a,{placeholder:"Search...",onChange:function(t){e.search=t.target.value},value:e.search,onKeyPress:function(t){if("Enter"===t.key)try{e.fetchSongs()}catch(n){l.a.danger("An error has occured.")}}})]})}),Object(N.jsxs)(M.a,{minWidth:"400px",overflowX:"scroll",children:[Object(N.jsxs)(M.a.Head,{height:42,children:[Object(N.jsx)(M.a.HeaderCell,{flexBasis:40,flexGrow:0}),t.map((function(e){return Object(N.jsx)(M.a.TextHeaderCell,Object(u.a)(Object(u.a)({},W(e)),{},{children:V(e)}),e)}))]}),Object(N.jsx)(c.c,{droppableId:_e,isDropDisabled:!0,children:function(n,a){return Object(N.jsxs)(M.a.Body,{overflow:"visible",display:"flex",flexDirection:"column",ref:n.innerRef,children:[Object(N.jsx)(o.a,{children:function(){return e.songsList.map((function(e,n){return Object(N.jsx)(c.b,{draggableId:"browser-".concat(e.hash),index:n,children:function(n,a){return Object(N.jsxs)(M.a.Row,Object(u.a)(Object(u.a)(Object(u.a)({height:40,ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{children:[Object(N.jsx)(M.a.Cell,{flexBasis:40,flexGrow:0,flexShrink:0,children:Object(N.jsx)(ke,{songData:e})}),t.map((function(t){return Y(t,new ce(e.hash,e))}))]}),e.hash)}},e.hash)}))}}),n.placeholder]})}})]}),Object(N.jsx)(ve.a,{page:e.page+1,totalPages:e.totalPages,onPageChange:function(t){e.page=t-1,e.fetchSongs()}})]})})),Be=n(37),Pe=n(229),Te=n(230),Ae=n(232),Le=n(89),Ie=n(231),De=n(243),He=n(195),Re=Object(o.b)((function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],i=t[1];return Object(N.jsxs)(h.a,{width:"100%",height:"250px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:"20px",paddingRight:"20px",paddingTop:"10px",paddingBottom:"10px",background:"linear-gradient(45deg, #f03030 0%, #309eff 80%)",children:[Object(N.jsxs)(k.a,{color:"white",size:900,children:["BeaterList"," ",Object(N.jsx)(Ie.a,{color:"white",onClick:function(){window.gtag("event","toggleHelp",{event_category:"sidebarConfig",event_label:"toggleHelp",value:!n}),i(!n)}})]}),Object(N.jsxs)(E.a,{color:"white",children:["by"," ",Object(N.jsx)("a",{href:"https://zexuan.tk/projects/#beaterlist",rel:"noopener noreferrer",target:"blank",style:{color:"white"},children:"zexurge"})]}),Object(N.jsx)(De.a,{isShown:n,onCloseComplete:function(){window.gtag("event","closeHelp",{event_category:"sidebarConfig",event_label:"closeHelp"}),i(!1)},children:Object(N.jsxs)(h.a,{margin:40,children:[Object(N.jsx)(k.a,{children:"Things to know"}),Object(N.jsx)(He.a,{marginTop:10,children:"Any changes you make will be saved automatically, so you don't have to worry about losing data when refreshing. (if it happens, let me know so I can fix the bug)"}),Object(N.jsx)(He.a,{marginTop:10,children:"ALL of the data here is stored locally in your browser. This means that if there are any updates to this site, or if you are using incognito mode, or clear the browser data, ALL of the data will be lost!"}),Object(N.jsx)(He.a,{marginTop:10,children:"So, do backup your data often :)"}),Object(N.jsx)(k.a,{marginTop:20,children:"How to use"}),Object(N.jsx)(He.a,{marginTop:10,children:"You can start by creating an empty playlist on the sidebar on the left, or import existing .bplist files or .json files from your Playlists folder to load your playlists."}),Object(N.jsx)(He.a,{marginTop:10,children:"You can then start to add new songs (by key) to the playlists directly, re-order them by drag-and-dropping them around. The songs can also be moved between playlists."}),Object(N.jsx)(He.a,{marginTop:10,children:"You can also reorder the playlists themselves by dragging them (though the d-n-d UI is still a bit buggy for now)."}),Object(N.jsx)(k.a,{marginTop:20,children:"BeatSaver browser"}),Object(N.jsx)(He.a,{marginTop:10,children:"I have integrated a BeatSaver browser here, so you can browse for songs here and drag-and-drop them directly to your playlists! I have also setup a simple preview song functionality so you can quickly find and add songs you like."}),Object(N.jsx)(k.a,{marginTop:20,children:"Exporting playlists"}),Object(N.jsx)(He.a,{marginTop:10,children:"You can download each playlist individually by clicking the save icon at the top of each playlist. Or, just export them all in a .zip file using the 'Export all playlists' button."}),Object(N.jsx)(He.a,{marginTop:10,children:"You can then just dump the files into the Playlists folder, and refresh the playlists in game, or import them individually using ModAssistant (or via BMBF/Playlist Editor Pro for Quest)"})]})})]})})),Ee=n(90),Ne=Object(o.b)((function(e){var t=e.onImportClick,n=Object(Ee.a)(e,["onImportClick"]);return Object(N.jsx)(Be.a,Object(u.a)(Object(u.a)({onClick:function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("multiple",!0),e.setAttribute("accept",".bplist,.json"),e.addEventListener("change",function(){var e=Object(w.a)(m.a.mark((function e(n){var a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object.values(n.target.files),e.next=3,Promise.all(a.map(function(){var e=Object(w.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.name.split(".")[1],e.t1=JSON,e.next=4,t.text();case 4:return e.t2=e.sent,e.t3=e.t1.parse.call(e.t1,e.t2),e.abrupt("return",{type:e.t0,data:e.t3});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:i=e.sent,t(i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},n),{},{children:"Import playlist(s)"}))})),ze=Object(o.b)((function(){var e=Object(a.useContext)(x),t=e.playlistHorizontalMode,n=e.playlistColumnsToShow,i=Object(a.useContext)(he),s=Object(a.useState)(!1),r=Object(d.a)(s,2),o=r[0],c=r[1],u=Object(a.useState)(!1),h=Object(d.a)(u,2),g=h[0],f=h[1];return Object(N.jsxs)("div",{style:{backgroundColor:"white",height:"100vh"},children:[Object(N.jsx)(Re,{}),Object(N.jsxs)("div",{style:{display:"flex",flexDirection:"column",paddingTop:20,paddingBottom:20,paddingLeft:30,paddingRight:30},children:[Object(N.jsx)(Be.a,{onClick:function(){window.gtag("event","showBeatSaverBrowser",{event_category:"sidebarConfig",event_label:"showBeatSaverBrowser",value:!e.showBeatSaverBrowser}),e.showBeatSaverBrowser=!e.showBeatSaverBrowser},marginBottom:"10px",children:e.showBeatSaverBrowser?Object(N.jsxs)(N.Fragment,{children:["Hide BeatSaver browser",Object(N.jsx)(Pe.a,{})]}):Object(N.jsxs)(N.Fragment,{children:["Show BeatSaver browser",Object(N.jsx)(Te.a,{})]})}),Object(N.jsx)(Be.a,{onClick:function(){window.gtag("event","createNewPlaylist",{event_category:"sidebarConfig",event_label:"createNewPlaylist"}),i.createNewPlaylist(),l.a.success("New Playlist created.")},marginBottom:"10px",children:"Add new playlist"}),Object(N.jsx)(Ne,{isLoading:o,marginBottom:"10px",onImportClick:function(){var e=Object(w.a)(m.a.mark((function e(t){var n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.gtag("event","importPlaylists",{event_category:"sidebarConfig",event_label:"importPlaylists",value:t.length}),c(!0),n=Object(Q.a)(t),e.prev=3,n.s();case 5:if((a=n.n()).done){e.next=11;break}return s=a.value,e.next=9,i.addPlaylistFromBplistData(s.data);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:c(!1),l.a.success("Successfully imported ".concat(t.length," playlist").concat(1===t.length?"":"s","."));case 21:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()}),Object(N.jsx)(Be.a,{isLoading:g,onClick:Object(w.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.gtag("event","exportPlaylists",{event_category:"sidebarConfig",event_label:"exportPlaylists"}),f(!0),t=new xe.a,i.playlists.forEach((function(e,n){t.file("[".concat(n,"]-").concat(e.title,".bplist"),JSON.stringify(e.asBplistJson()))})),e.next=6,t.generateAsync({type:"blob"});case 6:n=e.sent,Object(Le.saveAs)(n,"beaterlist-".concat((new Date).toLocaleDateString(),".zip")),f(!1);case 9:case"end":return e.stop()}}),e)}))),marginBottom:"10px",children:"Export all playlists"})]}),Object(N.jsxs)("div",{style:{paddingLeft:20,paddingRight:20},children:[Object(N.jsx)(k.a,{children:"Playlists Config"}),Object(N.jsx)(Ae.a,{label:"Horizontal Mode",checked:t,onChange:function(t){window.gtag("event","toggleHorizontalMode",{event_category:"sidebarConfig",event_label:"toggleHorizontalMode",value:t.target.checked}),e.playlistHorizontalMode=t.target.checked}}),Object(N.jsx)(k.a,{children:"Columns To Show"}),Object.keys(e.playlistColumnsToShow).map((function(t){return Object(N.jsx)(Ae.a,{label:U(t),checked:n[t],onChange:function(a){window.gtag("event","columnsToShow",{event_category:"sidebarConfig",event_label:"columnsToShow",value:JSON.stringify(n)}),e.setPlaylistColumnToShow(t,a.target.checked)}},t)}))]})]})})),Me=Object(o.b)((function(){var e=Object(a.useContext)(x);return Object(N.jsx)("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",border:"default",backgroundColor:"#f9f9f9"},children:Object(N.jsxs)("div",{style:{width:"100%",flexDirection:"row",display:"flex"},children:[Object(N.jsx)("div",{style:{minWidth:250},children:Object(N.jsx)(ze,{})}),Object(N.jsxs)(c.a,{onDragEnd:function(e){try{!function(e){var t=e.destination,n=e.source;if(t&&n){var a=t.index,i=n.index;if(t.droppableId!==n.droppableId||a!==i){if(n.droppableId===_e){var s=ue.playlists.find((function(e){return e.id===t.droppableId})),r=se.songsList[n.index];if(s.songs.find((function(e){return e.hash===r.hash})))throw Error("Song already exists in this playlist.");return s.addSongBySongData(r,a),void ue.saveAllPlaylists()}if(n.droppableId===de&&t.droppableId===de){var o=ue.playlists[n.index];return ue.movePlaylist(o,t.index),void ue.saveAllPlaylists()}var c=ue.playlists.find((function(e){return e.id===n.droppableId}));if(t.droppableId===n.droppableId){var l=c.songs[i];c.removeSong(l),c.insertSongAtIdx(l,a)}else{var u=ue.playlists.find((function(e){return e.id===t.droppableId})),h=c.songs[i];if(u.songs.find((function(e){return e.hash===h.hash})))throw Error("Song already exists in this playlist.");c.removeSong(h),u.insertSongAtIdx(h,a)}ue.saveAllPlaylists()}}}(e)}catch(t){console.error(t),l.a.danger(t.message)}},children:[e.showBeatSaverBrowser&&Object(N.jsx)(Ce,{}),Object(N.jsx)(fe,{})]})]})})})),Fe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,244)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),s(e),r(e)}))};r.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(he.Provider,{value:ue,children:Object(N.jsx)(re.Provider,{value:se,children:Object(N.jsx)(x.Provider,{value:y,children:Object(N.jsx)(Me,{})})})})}),document.getElementById("root")),Fe()},99:function(e,t,n){}},[[191,1,2]]]);
//# sourceMappingURL=main.5fd7224f.chunk.js.map